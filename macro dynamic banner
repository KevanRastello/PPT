
Sub AddSectionLabelsWithHighlight()
    ' === DEFINE YOUR SECTION NAMES AND SLIDE RANGES ===
    Dim sectionData As Variant
    sectionData = Array( _
        Array("Introduction", 1, 3), _
        Array("Biology", 4, 6), _
        Array("Model", 7, 10), _
        Array("Take-home", 11, 13))
    
    ' === STYLE SETTINGS ===
    Dim bannerTop As Single: bannerTop = 5
    Dim textHeight As Single: textHeight = 20
    Dim barHeight As Single: barHeight = 3
    Dim textColorActive As Long: textColorActive = RGB(0, 0, 0) ' black
    Dim textColorInactive As Long: textColorInactive = RGB(150, 150, 150) ' gray
    Dim barColor As Long: barColor = RGB(0, 176, 240) ' blue highlight

    ' === INTERNAL VARIABLES ===
    Dim slideWidth As Single: slideWidth = ActivePresentation.PageSetup.slideWidth
    Dim sectionCount As Integer: sectionCount = UBound(sectionData) - LBound(sectionData) + 1
    Dim spacing As Single: spacing = slideWidth / sectionCount
    Dim i As Integer, sectionIndex As Integer
    Dim sld As Slide, shp As Shape
    Dim secName As String, secStart As Integer, secEnd As Integer
    Dim labelLeft As Single

    ' === LOOP THROUGH SLIDES ===
    For Each sld In ActivePresentation.Slides
        ' Remove existing section elements
        For Each shp In sld.Shapes
            If Left(shp.Name, 14) = "SectionLabel_" Or Left(shp.Name, 13) = "SectionLine_" Then
                shp.Delete
            End If
        Next shp

        ' Identify current section index
        sectionIndex = -1
        For i = 0 To UBound(sectionData)
            secStart = sectionData(i)(1)
            secEnd = sectionData(i)(2)
            If sld.slideIndex >= secStart And sld.slideIndex <= secEnd Then
                sectionIndex = i
                Exit For
            End If
        Next i

        ' Add section labels and highlight line
        For i = 0 To UBound(sectionData)
            secName = sectionData(i)(0)
            labelLeft = i * spacing + spacing / 2 - 50 ' Center-ish offset

            ' Add text label
            Set shp = sld.Shapes.AddTextbox( _
                Orientation:=msoTextOrientationHorizontal, _
                Left:=labelLeft, Top:=bannerTop, Width:=100, Height:=textHeight)

            With shp
                .Name = "SectionLabel_" & i
                .TextFrame2.TextRange.Text = secName
                .TextFrame2.TextRange.Font.Size = 14
                .TextFrame2.TextRange.Font.Bold = IIf(i = sectionIndex, msoTrue, msoFalse)
                .TextFrame2.TextRange.Font.Fill.ForeColor.RGB = _
                    IIf(i = sectionIndex, textColorActive, textColorInactive)
                .TextFrame2.TextRange.ParagraphFormat.Alignment = ppAlignCenter
                .TextFrame2.VerticalAnchor = msoAnchorMiddle
                .Line.Visible = msoFalse
            End With

            ' Add underline bar only for active section
            If i = sectionIndex Then
                Set shp = sld.Shapes.AddShape(msoShapeRectangle, _
                    Left:=labelLeft + 15, Top:=bannerTop + textHeight, _
                    Width:=70, Height:=barHeight)
                With shp
                    .Name = "SectionLine_" & i
                    .Fill.ForeColor.RGB = barColor
                    .Line.Visible = msoFalse
                End With
            End If
        Next i
    Next sld
End Sub


